<script>
  const canvas = document.getElementById('flux-canvas');
  const ctx = canvas.getContext('2d');

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    drawFluxPath();
  }

  window.addEventListener('resize', resizeCanvas);

  const fluxSymbols = ["†", "°", "÷", "V", "c", "!", "+", "="];

  const symbolMap = {
    "†": { x: 0, y: 9, z: 2 },
    "°": { x: 1, y: 1, z: 4 },
    "÷": { x: -1, y: 6, z: 5 },
    "V": { x: 5, y: 3, z: 2 },
    "c": { x: 3, y: 8, z: 1 },
    "!": { x: 0, y: 10, z: 0 },
    "+": { x: 2, y: 6, z: 7 },
    "=": { x: 0, y: 0, z: 0 }
  };

  function drawFluxPath() {
    if (!canvas || !ctx) return;

    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.lineWidth = 3;

    for (let i = 0; i < fluxSymbols.length - 1; i++) {
      const symA = fluxSymbols[i];
      const symB = fluxSymbols[i + 1];

      const a = symbolMap[symA];
      const b = symbolMap[symB];

      if (!a || !b) continue;

      const scale = 60;

      const x1 = canvas.width / 2 + a.x * scale;
      const y1 = canvas.height / 2 - a.y * scale;
      const x2 = canvas.width / 2 + b.x * scale;
      const y2 = canvas.height / 2 - b.y * scale;

      const hue = 40 + a.z * 30;
      ctx.strokeStyle = `hsl(${hue}, 90%, 60%)`;

      ctx.beginPath();
      ctx.moveTo(x1, y1);
      ctx.lineTo(x2, y2);
      ctx.stroke();

      // Draw symbol label
      ctx.fillStyle = "#ffffff";
      ctx.font = "18px monospace";
      ctx.fillText(symA, x1 + 6, y1 - 6);
    }

    // Draw last symbol
    const last = symbolMap[fluxSymbols[fluxSymbols.length - 1]];
    if (last) {
      const lx = canvas.width / 2 + last.x * 60;
      const ly = canvas.height / 2 - last.y * 60;
      ctx.fillText(fluxSymbols[fluxSymbols.length - 1], lx + 6, ly - 6);
    }
  }

  resizeCanvas();
</script>
